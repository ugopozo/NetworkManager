if ENABLE_TESTS

include $(top_srcdir)/nm.mk

AM_CPPFLAGS = \
	-I$(top_srcdir)/shared \
	-I$(top_builddir)/shared \
	-I$(top_srcdir)/libnm-core \
	-I$(top_builddir)/libnm-core \
	-I$(top_srcdir)/src \
	-I$(top_srcdir)/src/settings \
	-I$(srcdir)/../ \
	-DG_LOG_DOMAIN=\""NetworkManager"\" \
	-DNETWORKMANAGER_COMPILATION=NM_NETWORKMANAGER_COMPILATION_INSIDE_DAEMON \
	$(GLIB_CFLAGS) \
	-DTEST_ENI_DIR=\"$(abs_srcdir)\"

noinst_PROGRAMS = test-ifupdown

test_ifupdown_SOURCES = \
	test-ifupdown.c

test_ifupdown_LDFLAGS = \
	$(GLIB_LDFLAGS)
	$(CODE_COVERAGE_LDFLAGS)

test_ifupdown_LDADD = \
	$(top_builddir)/src/settings/plugins/ifupdown/libnms-ifupdown-core.la \
	$(top_builddir)/src/libNetworkManager.la

@VALGRIND_RULES@
TESTS = test-ifupdown

check-local:
	$(call check_so_symbols,$(builddir)/../.libs/libnm-settings-plugin-ifupdown.so)

endif

EXTRA_DIST = \
	test1 test2 test3 test4 test5 test6 test7 test8 test9 test11 test12 \
	test13 test14 test15 test16 test17-wired-static-verify-ip4 \
	test18-wired-static-verify-ip6 test19-wired-static-verify-ip4-plen \
	test20-source-stanza test20-source-stanza.eth0 test20-source-stanza.eth1 \
	test21-source-dir-stanza test21-source-dir-stanza.d
